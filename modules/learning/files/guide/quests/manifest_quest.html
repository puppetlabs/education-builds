<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Manifests</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>
    <div id="page" class="page">
        <div id="site-header" role="banner">
    <div class="header-wrapper">
        <div class"region region-header">
            <div id="block-boxes-test" class="block block-boxes block-boxes simple logo block-odd">
                <div class="content">
                    <a href="/">
                        <img src="/assets/Puppet-Labs-Logo.png">
                    </a>
                </div>
            </div>
            <div id="block-menu_block-2" class="block block-menu-block header-primary-menu block-even">
                <div class="content">
                    <div class="menu-block-wrapper menu-block-2 menu-name-main-menu parent-mlid-0 menu-level-1">
                        <ul class="menu">
                            <li>
                                <a href="/index.html">
                                    Quests
                                </a>
                            </li>
                            <li>
                                <a href="/glossary.html">
                                    Glossary
                                </a>
                            <li>
                                <a href="https://puppetlabs.com/learn" target="_blank">
                                    Learning Resources
                                </a>
                            </li>
                            <li>
                                <a href="http://docs.puppetlabs.com" target="_blank">
                                    Puppet Docs
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

        <div id="main" class="clearfix" role-"main">
        <aside id="sidebar-first" class="column sidebar first" role="complementary">
    <div id="sidebar-first-inner" class="inner">
        <div class="content">
            <h2>Quests</h2>
            <div class="menu-block-wrapper menu-block-7 menu-name-main-menu parent-mlid-0 meni-level-2">
                <ul class="menu">
                    
                        
                            <li>
                                <a href="/index.html">Welcome</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/big_picture.html">Power of Puppet</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/resources.html">Resources</a>
                            </li>
                        
                    
                        
                            <li class="active">
                                <a href="/quests/manifest_quest.html" class = "active">Manifests</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/variables.html">Variables</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/conditions_quest.html">Conditional Statements</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/resource_ordering.html">Ordering</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/classes_quest.html">Classes</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/modules_quest.html">Modules</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/quests/puppet_module_tool_quest.html">Puppet Module Tool</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/afterword.html">Afterword</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/glossary.html">Glossary</a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
    </div>
</aside>


            <div id="content" class="clearfix" role="main">
                <h1>Manifests</h1>

<h3>Prerequisites</h3>

<ul>
<li>Welcome Quest</li>
<li>Power of Puppet Quest</li>
<li>Resources Quest</li>
</ul>

<a id=""><h2>Quest Objectives</h2></a>

<ul>
<li>Understand the concept of a Puppet manifest</li>
<li>Construct and apply manifests to manage resources</li>
</ul>

<a id=""><h2>Getting Started</h2></a>

<p>As you saw in the Resources Quest, Puppet's resource declarations can be used to keep track of just about anything in this Learning VM. So far, you have made changes to the Learning VM without using Puppet. You looked at resource declarations using <code>puppet describe</code> and <code>puppet resource</code> only in order to track your effects. In this quest, you will learn to craft your own resource declarations and inscribe them in a special file called a <strong>manifest</strong>. When you're ready to get started, type the following command:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">quest --start manifest
</code></pre></div>
<div class="lvm-inline-aside">
<h4>Let's See What Quests You've Completed </h4>
<p></p>
<p>Before you get started, let's take a look at the quests you have completed. Type the following command:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">quest --completed
</code></pre></div>

<p>This is useful incase you forget which Quests you've already done. In this case it shows that you have completed three quests: (1)Welcome Quest (2)Power of Puppet Quest and (3)Resources Quest.</p>

<p></p>
</div>

<a id=""><h2>Puppet Manifests</h2></a>

<p>Manifests are files containing Puppet code. They are standard text files saved with the <code>.pp</code> file extension. The core of the Puppet language is the resource declaration as it describes a desired state for one resource. Puppet manifests contain resource declarations. Manifests, like the resource declarations they contain, are written in Puppet Language. </p>

<div class="lvm-inline-aside">
<h4>Don't Forget These Tools Too </h4>
<p></p>
<p>You can use <code>puppet describe</code> and <code>puppet resource</code> for help using and understanding the <code>user</code> resource...and any other resource type you're curious about.</p>
</div>

<p>Let's get started by making sure you're in your home directory: <code>/root</code>.  This is where you want to place newly created manifests.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">cd /root
</code></pre></div>
<div class="lvm-inline-aside">
<h4>Text Editors </h4>
<p></p>
<p>For the sake of simplicity and consistency, we use the text editor <code>nano</code> in our instructions, but feel free to use <code>vim</code> or another text editor of your choice.</p>
</div>

<div class="lvm-task-number"><p>Task 1 :</p></div>

<p>Create a manifest to remove user byte:</p>

<p>Unfortunately byte just doesn't seem to be working out as a sidekick. Let's create a manifest to get rid of byte. We will create a manifest, with some code in it. Type the following command, after you make sure you are in the <code>/root</code> directory as mentioned above:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">nano byte.pp
</code></pre></div>
<p>Type the following instructions into Byte's manifest:</p>

<div class="highlight"><pre><code class="puppet"><span class="nc">user</span> <span class="p">{</span> <span class="s1">'byte'</span><span class="p">:</span>
    <span class="nt">ensure</span> <span class="p">=&gt;</span> <span class="s1">'absent'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>

<p>Save the file and exit your text editor. We touched on this in the Resources Quests, but the <code>ensure =&gt; absent</code> attribute/value pair states that we are going to make sure user byte does not exist in the Learning VM.</p>

<a id=""><h2>Puppet Parser</h2></a>

<p>What if we made an error when writing our Puppet code? The <code>puppet parser</code> tool is Puppet's version of a syntax checker. When provided with a file as an argument, this tool validates the syntax of the code in the file without acting on the definitions and declarations within. If no manifest files are provided, Puppet will validate the default <code>site.pp</code> manifest. If there are no syntax errors, Puppet will return nothing when this command is ran, otherwise Puppet will display the first syntax error encountered. </p>

<div class="lvm-callout lvm-warning"><p>
The `puppet parser` tool can only ensure that the syntax of a manifest is well-formed. It cannot guarantee that your variables are correctly named, your logic is valid, or that your manifest does what you want it to.
</p></div>

<div class="lvm-task-number"><p>Task 2 :</p></div>

<p>Using the <code>puppet parser</code> tool, let's check your manifest for any syntax errors. Type the following command:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">puppet parser validate byte.pp
</code></pre></div>
<p>Again, if the parser returns nothing, continue on. If not, make the necessary changes and re-validate until the syntax checks out.</p>

<a id=""><h2>Puppet Apply</h2></a>

<p>Once you've created a manifest you will use the <code>puppet apply</code> tool to enforce it. The <code>puppet apply</code> tool enables you to apply individual manifests locally.  In the real world, you may want an easier method to apply multiple definitions across multiple systems from a central source. We will get there when we talk about classes and modules. For now, however, manifests, and <code>puppet apply</code> aid in learning the Puppet language in small, iterative steps. </p>

<p>When you run <code>puppet apply</code> with a manifest file as the argument, a <em>catalog</em> is generated containing a list of all resources in the manifest, along with the desired state you specified. Puppet will check each resource in your environment against the resource declaration in the manifest. Puppet's <strong>providers</strong> will then do everything necessary to bring the state of those resources in line with the resource declarations in your manifest. </p>

<div class="lvm-task-number"><p>Task 3 :</p></div>

<p>Once your <code>byte.pp</code> manifest is error free, we're going to simulate the change in the Learning VM without actually enforcing those changes. Let's see what happens:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">puppet apply --noop byte.pp
</code></pre></div>
<p>In the returned output, Puppet tells us that it has not made the changes to the Learning VM, but if it had, this is what would be changed.</p>

<div class="lvm-task-number"><p>Task 4 :</p></div>

<p>Since the simulated change is what we want, let's enforce the change on the Learning VM.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">puppet apply byte.pp
</code></pre></div>
<div class="lvm-task-number"><p>Task 5 :</p></div>

<p>How is byte doing?</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">HINT: Use the puppet resource command discussed in the Resource Quest.
</code></pre></div>
<p>byte does not seem to be doing well. Actually, he's gone. The <code>ensure =&gt; 'absent'</code> value clearly made short work of the user account.</p>

<div class="lvm-task-number"><p>Task 6 :</p></div>

<p>With Puppet manifests you can create as well as destroy. Lets create a new, stronger sidekick by adding user <code>gigabyte</code> to the Learning VM using Puppet. If you need help on how to do this, refer to the previous tasks you've just completed in this quest. One thing to note: <code>ensure =&gt; 'present'</code> will make sure GigaByte exists in the Learning VM.</p>

<p>The steps include creating a manifest file, and writing the minimal amount of Puppet code required to ensure that the user account is created. This task will be marked complete when the user exists on the system.</p>

<a id=""><h2>Review</h2></a>

<p>This is a foundational quest you must understand in order to successfully use Puppet. As you saw when completing this quest we've added two new tools to your toolbox: <code>puppet parser</code> and <code>puppet apply</code>. You always want to use <code>puppet parser</code> to check the syntax of your manifest before using <code>puppet apply</code> to enforce it. This quest contained a walkthough of the "best practice" methods to creating, checking, applying your manifest. We've also have a simplified version below for your reference:</p>

<ol>
<li>Open or create a manifest with the <code>.pp</code> extension</li>
<li>Add or edit your Puppet code</li>
<li>Use the <code>puppet parser</code> tool to check for syntax errors <em>(recommended)</em>
</li>
<li>Simulate your manifest using <code>puppet apply --noop</code> <em>(recommended)</em>
</li>
<li>Enfore your manifest using <code>puppet apply</code>
</li>
<li>Check to make sure everything is working correctly <em>(recommended)</em>
</li>
</ol>

<p>As a final note, if you go back to the Power of Puppet quest, you will notice that the init.pp file containing the definition for <code>class lvmguide</code> is a manifest. </p>

            </div>
        </div>
        <div id="footer">
</div>
       
    </div>
    </body>
</html>
